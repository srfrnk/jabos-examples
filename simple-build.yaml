apiVersion: jabos.io/v1
kind: GitRepository
metadata:
  name: first-repo
  namespace: example-env
spec:
  url: https://github.com/srfrnk/jabos-examples.git
  branch: main
---
apiVersion: jabos.io/v1
kind: DockerImage
metadata:
  name: first-image
  namespace: example-env
spec:
  gitRepository: first-repo
  contextPath: simple-runtime/images
  imageName: registry.kube-system:80/example-image-dev
---
apiVersion: jabos.io/v1
kind: JsonnetManifest
metadata:
  name: simple-jsonnet-manifest
  namespace: example-env
spec:
  gitRepository: first-repo
  path: simple-runtime/manifests
  targetNamespace: example-env
  commitTLAKey: latestCommitId
  cleanupPolicy: Delete
  tlas:
    env: dev
---
apiVersion: jabos.io/v1
kind: DockerImage
metadata:
  name: first-image-docker-hub-public
  namespace: example-env
spec:
  gitRepository: first-repo
  contextPath: simple-runtime/images
  imageName: jabos/example-image-public
  dockerHub:
    secret: docker-hub
---
apiVersion: jabos.io/v1
kind: DockerImage
metadata:
  name: first-image-docker-hub-private
  namespace: example-env
spec:
  gitRepository: first-repo
  contextPath: simple-runtime/images
  imageName: jabos/example-image-private
  dockerHub:
    secret: docker-hub
---
apiVersion: jabos.io/v1
kind: DockerImage
metadata:
  name: first-image-docker-gcr
  namespace: example-env
spec:
  gitRepository: first-repo
  contextPath: simple-runtime/images
  imageName: gcr.io/jabos-331114/example-image
  gcp:
    secret: gcp
---
apiVersion: jabos.io/v1
kind: DockerImage
metadata:
  name: first-image-docker-artifact-registry
  namespace: example-env
spec:
  gitRepository: first-repo
  contextPath: simple-runtime/images
  imageName: europe-west2-docker.pkg.dev/jabos-331114/jabos/example-image
  gcp:
    secret: gcp
---
apiVersion: jabos.io/v1
kind: DockerImage
metadata:
  name: first-image-docker-ecr
  namespace: example-env
spec:
  gitRepository: first-repo
  contextPath: simple-runtime/images
  imageName: 524835905417.dkr.ecr.eu-west-2.amazonaws.com/example-image
  aws:
    secret: aws
---
apiVersion: jabos.io/v1
kind: PlainManifest
metadata:
  name: simple-plain-manifest
  namespace: example-env
spec:
  gitRepository: first-repo
  path: simple-runtime/plain-manifests
  targetNamespace: example-env
  replacementPrefix: "\\*\\*"
  replacementSuffix: "\\*\\*"
  commitReplacementString: LATEST_COMMIT_ID
  cleanupPolicy: Delete
  replacements:
    env: dev
---
apiVersion: jabos.io/v1
kind: HelmTemplateManifest
metadata:
  name: simple-helm-template-manifest
  namespace: example-env
spec:
  gitRepository: first-repo
  path: simple-runtime/helm-template
  targetNamespace: example-env
  commitValueKey: LATEST_COMMIT_ID
  cleanupPolicy: Delete
  values:
    env: dev
---
apiVersion: jabos.io/v1
kind: KustomizeManifest
metadata:
  name: simple-kustomize-manifest
  namespace: example-env
spec:
  gitRepository: first-repo
  path: simple-runtime/kustomize
  targetNamespace: example-env
  dockerImages:
    - first-image
    - first-image-docker-hub-public
    - first-image-docker-hub-private
  cleanupPolicy: Delete
  replacementPrefix: "\\*\\*"
  replacementSuffix: "\\*\\*"
  replacements:
    env: dev
---
apiVersion: jabos.io/v1
kind: GitRepository
metadata:
  name: first-repo
  namespace: example-env-stg
spec:
  url: https://github.com/srfrnk/jabos-examples.git
  branch: stg
---
apiVersion: jabos.io/v1
kind: DockerImage
metadata:
  name: first-image
  namespace: example-env-stg
spec:
  gitRepository: first-repo
  contextPath: simple-runtime/images
  imageName: registry.kube-system:80/example-image-stg
---
apiVersion: jabos.io/v1
kind: JsonnetManifest
metadata:
  name: simple-jsonnet-manifest
  namespace: example-env-stg
spec:
  gitRepository: first-repo
  path: simple-runtime/manifests
  targetNamespace: example-env-stg
  commitTLAKey: latestCommitId
  cleanupPolicy: Delete
  tlas:
    env: stg
---
apiVersion: jabos.io/v1
kind: DockerImage
metadata:
  name: first-image-reuse-dev
  namespace: example-env-stg
spec:
  gitRepository: first-repo
  contextPath: simple-runtime/images
  imageName: registry.kube-system:80/example-image-dev-2
  # build: false
---
apiVersion: jabos.io/v1
kind: JsonnetManifest
metadata:
  name: simple-jsonnet-manifest-reuse-dev
  namespace: example-env-stg
spec:
  gitRepository: first-repo
  path: simple-runtime/manifests
  targetNamespace: example-env-stg
  commitTLAKey: latestCommitId
  cleanupPolicy: Delete
  tlas:
    env: dev-2
